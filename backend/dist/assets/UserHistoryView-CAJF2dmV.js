import{_ as T,d as C,c as r,b as o,a as k,n as b,l as w,w as f,e as y,m as D,F as S,r as V,f as l,o as L,h as g,j as $,k as i,t as c,p as U}from"./index-CGiBp5pr.js";const q=C({name:"UserHistoryView",setup(){const s=$(),e=l("views"),d=l([]),u=l([]),p=l(!0),v=l(!0),n=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),t=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),h=async a=>{try{await g.saveSearchHistory(a),s.push({path:"/",query:{q:a}})}catch(m){console.error("Error executing search:",m)}},_=async()=>{try{p.value=!0;const a=await g.getUserPaperViews(50,30);d.value=a.views||[]}catch(a){console.error("Failed to load paper view history:",a),d.value=[]}finally{p.value=!1}},H=async()=>{try{v.value=!0;const a=await g.getUserSearchHistory();u.value=a.searches||[]}catch(a){console.error("Failed to load search history:",a),u.value=[]}finally{v.value=!1}};return L(()=>{_(),H()}),{activeTab:e,paperViews:d,searchHistory:u,isLoadingViews:p,isLoadingSearches:v,formatDate:n,formatDateTime:t,executeSearch:h}}}),B={class:"user-history-view"},F={class:"tabs"},N={key:0,class:"history-content"},P={key:0,class:"loading"},Y={key:1,class:"empty-state"},E={key:2,class:"paper-views-list"},M={class:"view-info"},R={class:"view-date"},j={class:"view-count"},z={key:1,class:"history-content"},G={key:0,class:"loading"},I={key:1,class:"empty-state"},A={key:2,class:"search-history-list"},J={class:"search-time"},K={class:"search-query"},O=["onClick"];function Q(s,e,d,u,p,v){const n=D("router-link");return i(),r("div",B,[e[8]||(e[8]=o("h1",null,"Your Reading History",-1)),o("div",F,[o("button",{class:b(["tab-button",{active:s.activeTab==="views"}]),onClick:e[0]||(e[0]=t=>s.activeTab="views")}," View History ",2),o("button",{class:b(["tab-button",{active:s.activeTab==="searches"}]),onClick:e[1]||(e[1]=t=>s.activeTab="searches")}," Search History ",2)]),s.activeTab==="views"?(i(),r("div",N,[s.isLoadingViews?(i(),r("div",P,e[2]||(e[2]=[o("p",null,"Loading view history...",-1)]))):s.paperViews.length===0?(i(),r("div",Y,[e[4]||(e[4]=o("p",null,"You haven't viewed any papers yet",-1)),w(n,{to:"/",class:"action-button"},{default:f(()=>e[3]||(e[3]=[y("Browse Papers")])),_:1})])):(i(),r("div",E,[(i(!0),r(S,null,V(s.paperViews,t=>(i(),r("div",{key:t.paper_id,class:"paper-view-item"},[o("div",M,[o("div",R,[y(c(s.formatDate(t.view_date))+" ",1),o("span",j,"("+c(t.view_count)+" times)",1)]),w(n,{to:{name:"paper-detail",params:{id:t.paper_id}},class:"paper-title"},{default:f(()=>[y(c(t.title||t.paper_id),1)]),_:2},1032,["to"])])]))),128))]))])):k("",!0),s.activeTab==="searches"?(i(),r("div",z,[s.isLoadingSearches?(i(),r("div",G,e[5]||(e[5]=[o("p",null,"Loading search history...",-1)]))):s.searchHistory.length===0?(i(),r("div",I,[e[7]||(e[7]=o("p",null,"You haven't made any searches yet",-1)),w(n,{to:"/",class:"action-button"},{default:f(()=>e[6]||(e[6]=[y("Go Search")])),_:1})])):(i(),r("div",A,[(i(!0),r(S,null,V(s.searchHistory,(t,h)=>(i(),r("div",{key:h,class:"search-item"},[o("div",J,c(s.formatDateTime(t.timestamp)),1),o("div",K,[o("a",{href:"#",onClick:U(_=>s.executeSearch(t.query),["prevent"]),class:"search-link"},c(t.query),9,O)])]))),128))]))])):k("",!0)])}const X=T(q,[["render",Q],["__scopeId","data-v-3526dba0"]]);export{X as default};
